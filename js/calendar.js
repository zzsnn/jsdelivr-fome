"use strict";!function(z){function n(t,e,n){var a,r=new Date,l=r.getDate(),L=r.getMonth(),j=r.getFullYear(),O=l,A=L,S=j,W=n,s=null,o=null,E={posts:[],prev:null,next:null},u="en";(a=t)&&"undefined"!=typeof calLanguages&&calLanguages[a]&&(u=a);var R=z.extend({},z.fn.aCalendar.defaults,"undefined"==typeof calLanguages?{}:calLanguages[u],e);function J(){A<11?A++:(A=0,S++),d()}function U(){0<A?A--:(A=11,S--),d()}function Y(t){t&&(S=t.getFullYear(),A=t.getMonth(),d())}function $(){R.single?null!=R.url&&""!=R.url&&(null===s&&z.ajax({url:R.url,async:!1,success:function(t){s=t,p(Object.keys(s))}}),null!==s&&i()&&(E.posts=s[S+"-"+(A+1)])):function(){null===o&&z.ajax({url:R.root+"list.json",async:!1,success:function(t){p(t)}});i()&&z.ajax({url:R.root+S+"-"+(A+1)+".json",async:!1,success:function(t){E.posts=t}})}()}function p(t){o=t.map(function(t){var e=t.split("-");return new Date(Date.UTC(+e[0],e[1]-1))})}function i(){var t=Date.UTC(S,A);if(null!==o&&0!==o.length&&(0!==E.posts.length||!(null===E.prev&&null!==E.next&&E.next.getTime()>t||null===E.next&&null!==E.prev&&E.prev.getTime()<t))){E.posts=[];for(var e=0;e<o.length;e++){var n=o[e].getTime();if(t===n)return E.prev=0===e?null:o[e-1],E.next=e===o.length-1?null:o[e+1],1;if(t<n){E.prev=0===e?null:o[e-1],E.next=o[e];break}E.prev=o[e],E.next=null}}}function N(t,e){var n={"LMM+":R.months[t.getMonth()],"MM+":t.getMonth()+1};for(var a in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length))),n)new RegExp("("+a+")").test(e)&&(e=e.replace(RegExp.$1,"LMM+"===a?n[a]:("00"+n[a]).substr((""+n[a]).length)));return e}function d(){$();var t=new Date(S,A,1).getDay()-R.weekOffset;t<=0&&(t=6- -1*(t+1));var e=new Date(S,A+1,0).getDate(),n=new Date(S,A,0).getDate()-t+1,a=z("<div/>").addClass("cal-head"),r=z("<div/>"),l=z("<div/>"),s=z("<div/>").addClass("cal-title");l.html(R.headArrows.previous),r.html(R.headArrows.next),curDate=new Date(Date.UTC(S,A)),0===E.posts.length?s.html(N(curDate,R.titleFormat)):(cTitleLink=z("<a/>").attr("href",N(curDate,R.titleLinkFormat)).attr("title",N(curDate,R.postsMonthTip)).html(N(curDate,R.titleFormat)),s.html(cTitleLink)),l.on("click",U),r.on("click",J),a.append(l),a.append(s),a.append(r);for(var o=z("<table/>").addClass("cal"),u=R.weekOffset,p=z("<thead/>"),i=z("<tr/>"),d=0;d<7;d++){6<u&&(u=0);var c=z("<th/>").attr("scope","col").attr("title",R.dayOfWeek[u]);c.html(R.dayOfWeekShort[u]),i.append(c),u++}p.append(i),o.append(p);var h=z("<tfoot/>"),f=z("<tr/>"),g=z("<td/>").attr("colspan",3),y=z("<td/>").html("&nbsp;"),v=z("<td/>").attr("colspan",3);E.prev&&g.html(R.footArrows.previous+R.months[E.prev.getMonth()]).addClass("cal-foot").attr("title",N(E.prev,R.postsMonthTip)),E.next&&v.html(R.months[E.next.getMonth()]+R.footArrows.next).addClass("cal-foot").attr("title",N(E.next,R.postsMonthTip)),g.on("click",function(){Y(E.prev)}),v.on("click",function(){Y(E.next)}),f.append(g),f.append(y),f.append(v),h.append(f);for(var m=z("<tbody/>"),M=1,x=1,d=0;d<6;d++){for(var D=z("<tr/>"),k=0;k<7;k++){var w=z("<td/>");if(7*d+k<t)w.addClass("cal-gray"),w.html(n++);else if(M<=e){M==O&&L==A&&j==S&&w.addClass("cal-today");for(var T,C,b={num:0,keys:[]},F=0;F<E.posts.length;F++){new Date(Date.parse(E.posts[F].date)).getDate()==M&&(b.keys[b.num++]=F)}0!==b.num?(T=b.keys[0],C=z("<a>").attr("href",E.posts[T].link).attr("title",E.posts[T].title).html(M++),w.append(C)):w.html(M++)}else w.addClass("cal-gray"),w.html(x++);D.append(w)}m.append(D)}o.append(p),o.append(h),o.append(m),z(W).html(a),z(W).append(o)}return"/"!==R.root[0]&&(R.root="/"+R.root),"/"!==R.root[R.root.length-1]&&(R.root+="/"),d()}z.fn.aCalendar=function(t,e){return this.each(function(){return n(t,e,z(this))})},z.fn.aCalendar.defaults={months:["January","February","March","April","May","June","July","August","September","October","November","December"],dayOfWeekShort:["S","M","T","W","T","F","S"],dayOfWeek:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],postsMonthTip:"Posts published in LMM yyyy",titleFormat:"yyyy LMM",titleLinkFormat:"/archives/yyyy/MM/",headArrows:{previous:'<span class="cal-prev"></span>',next:'<span class="cal-next"></span>'},footArrows:{previous:"« ",next:" »"},weekOffset:0,single:!0,root:"/calendar/",url:"https://cdn.jsdelivr.net/gh/TheFine/theFine.github.io/calendar.json"},z(document).ready(function(){z("#calendar").aCalendar("zh-CN")})}(jQuery);